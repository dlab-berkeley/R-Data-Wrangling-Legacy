<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>R Wrangling</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/reveal.js-3.3.0.1/css/reveal.css"/>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="index_files/reveal.js-3.3.0.1/css/theme/serif.css" id="theme">


  <!-- some tweaks to reveal css -->
  <style type="text/css">
    .reveal h1 { font-size: 2.0em; }
    .reveal h2 { font-size: 1.5em;  }
    .reveal h3 { font-size: 1.25em;	}
    .reveal h4 { font-size: 1em;	}

    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0px 0px;
    }



    .reveal table {
      border-width: 1px;
      border-spacing: 2px;
      border-style: dotted;
      border-color: gray;
      border-collapse: collapse;
      font-size: 0.7em;
    }

    .reveal table th {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      font-weight: bold;
      border-style: dotted;
      border-color: gray;
    }

    .reveal table td {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      border-style: dotted;
      border-color: gray;
    }


  </style>

    <style type="text/css">code{white-space: pre;}</style>


<!-- Printing and PDF exports -->
<script id="paper-css" type="application/dynamic-css">

/* Default Print Stylesheet Template
   by Rob Glazebrook of CSSnewbie.com
   Last Updated: June 4, 2008

   Feel free (nay, compelled) to edit, append, and
   manipulate this file as you see fit. */


@media print {

	/* SECTION 1: Set default width, margin, float, and
	   background. This prevents elements from extending
	   beyond the edge of the printed page, and prevents
	   unnecessary background images from printing */
	html {
		background: #fff;
		width: auto;
		height: auto;
		overflow: visible;
	}
	body {
		background: #fff;
		font-size: 20pt;
		width: auto;
		height: auto;
		border: 0;
		margin: 0 5%;
		padding: 0;
		overflow: visible;
		float: none !important;
	}

	/* SECTION 2: Remove any elements not needed in print.
	   This would include navigation, ads, sidebars, etc. */
	.nestedarrow,
	.controls,
	.fork-reveal,
	.share-reveal,
	.state-background,
	.reveal .progress,
	.reveal .backgrounds {
		display: none !important;
	}

	/* SECTION 3: Set body font face, size, and color.
	   Consider using a serif font for readability. */
	body, p, td, li, div {
		font-size: 20pt!important;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		color: #000;
	}

	/* SECTION 4: Set heading font face, sizes, and color.
	   Differentiate your headings from your body text.
	   Perhaps use a large sans-serif for distinction. */
	h1,h2,h3,h4,h5,h6 {
		color: #000!important;
		height: auto;
		line-height: normal;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		text-shadow: 0 0 0 #000 !important;
		text-align: left;
		letter-spacing: normal;
	}
	/* Need to reduce the size of the fonts for printing */
	h1 { font-size: 28pt !important;  }
	h2 { font-size: 24pt !important; }
	h3 { font-size: 22pt !important; }
	h4 { font-size: 22pt !important; font-variant: small-caps; }
	h5 { font-size: 21pt !important; }
	h6 { font-size: 20pt !important; font-style: italic; }

	/* SECTION 5: Make hyperlinks more usable.
	   Ensure links are underlined, and consider appending
	   the URL to the end of the link for usability. */
	a:link,
	a:visited {
		color: #000 !important;
		font-weight: bold;
		text-decoration: underline;
	}
	/*
	.reveal a:link:after,
	.reveal a:visited:after {
		content: " (" attr(href) ") ";
		color: #222 !important;
		font-size: 90%;
	}
	*/


	/* SECTION 6: more reveal.js specific additions by @skypanther */
	ul, ol, div, p {
		visibility: visible;
		position: static;
		width: auto;
		height: auto;
		display: block;
		overflow: visible;
		margin: 0;
		text-align: left !important;
	}
	.reveal pre,
	.reveal table {
		margin-left: 0;
		margin-right: 0;
	}
	.reveal pre code {
		padding: 20px;
		border: 1px solid #ddd;
	}
	.reveal blockquote {
		margin: 20px 0;
	}
	.reveal .slides {
		position: static !important;
		width: auto !important;
		height: auto !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 0 !important;
		zoom: 1 !important;

		overflow: visible !important;
		display: block !important;

		text-align: left !important;
		-webkit-perspective: none;
		   -moz-perspective: none;
		    -ms-perspective: none;
		        perspective: none;

		-webkit-perspective-origin: 50% 50%;
		   -moz-perspective-origin: 50% 50%;
		    -ms-perspective-origin: 50% 50%;
		        perspective-origin: 50% 50%;
	}
	.reveal .slides section {
		visibility: visible !important;
		position: static !important;
		width: auto !important;
		height: auto !important;
		display: block !important;
		overflow: visible !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 60px 20px !important;
		z-index: auto !important;

		opacity: 1 !important;

		page-break-after: always !important;

		-webkit-transform-style: flat !important;
		   -moz-transform-style: flat !important;
		    -ms-transform-style: flat !important;
		        transform-style: flat !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;

		-webkit-transition: none !important;
		   -moz-transition: none !important;
		    -ms-transition: none !important;
		        transition: none !important;
	}
	.reveal .slides section.stack {
		padding: 0 !important;
	}
	.reveal section:last-of-type {
		page-break-after: avoid !important;
	}
	.reveal section .fragment {
		opacity: 1 !important;
		visibility: visible !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;
	}
	.reveal section img {
		display: block;
		margin: 15px 0px;
		background: rgba(255,255,255,1);
		border: 1px solid #666;
		box-shadow: none;
	}

	.reveal section small {
		font-size: 0.8em;
	}

}  
</script>


<script id="pdf-css" type="application/dynamic-css">
    
/**
 * This stylesheet is used to print reveal.js
 * presentations to PDF.
 *
 * https://github.com/hakimel/reveal.js#pdf-export
 */

* {
	-webkit-print-color-adjust: exact;
}

body {
	margin: 0 auto !important;
	border: 0;
	padding: 0;
	float: none !important;
	overflow: visible;
}

html {
	width: 100%;
	height: 100%;
	overflow: visible;
}

/* Remove any elements not needed in print. */
.nestedarrow,
.reveal .controls,
.reveal .progress,
.reveal .playback,
.reveal.overview,
.fork-reveal,
.share-reveal,
.state-background {
	display: none !important;
}

h1, h2, h3, h4, h5, h6 {
	text-shadow: 0 0 0 #000 !important;
}

.reveal pre code {
	overflow: hidden !important;
	font-family: Courier, 'Courier New', monospace !important;
}

ul, ol, div, p {
	visibility: visible;
	position: static;
	width: auto;
	height: auto;
	display: block;
	overflow: visible;
	margin: auto;
}
.reveal {
	width: auto !important;
	height: auto !important;
	overflow: hidden !important;
}
.reveal .slides {
	position: static;
	width: 100%;
	height: auto;

	left: auto;
	top: auto;
	margin: 0 !important;
	padding: 0 !important;

	overflow: visible;
	display: block;

	-webkit-perspective: none;
	   -moz-perspective: none;
	    -ms-perspective: none;
	        perspective: none;

	-webkit-perspective-origin: 50% 50%; /* there isn't a none/auto value but 50-50 is the default */
	   -moz-perspective-origin: 50% 50%;
	    -ms-perspective-origin: 50% 50%;
	        perspective-origin: 50% 50%;
}

.reveal .slides section {
	page-break-after: always !important;

	visibility: visible !important;
	position: relative !important;
	display: block !important;
	position: relative !important;

	margin: 0 !important;
	padding: 0 !important;
	box-sizing: border-box !important;
	min-height: 1px;

	opacity: 1 !important;

	-webkit-transform-style: flat !important;
	   -moz-transform-style: flat !important;
	    -ms-transform-style: flat !important;
	        transform-style: flat !important;

	-webkit-transform: none !important;
	   -moz-transform: none !important;
	    -ms-transform: none !important;
	        transform: none !important;
}

.reveal section.stack {
	margin: 0 !important;
	padding: 0 !important;
	page-break-after: avoid !important;
	height: auto !important;
	min-height: auto !important;
}

.reveal img {
	box-shadow: none;
}

.reveal .roll {
	overflow: visible;
	line-height: 1em;
}

/* Slide backgrounds are placed inside of their slide when exporting to PDF */
.reveal section .slide-background {
	display: block !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	z-index: -1;
}

/* All elements should be above the slide-background */
.reveal section>* {
	position: relative;
	z-index: 1;
}

/* Display slide speaker notes when 'showNotes' is enabled */
.reveal .speaker-notes-pdf {
	display: block;
	width: 100%;
	max-height: none;
	left: auto;
	top: auto;
	z-index: 100;
}

/* Display slide numbers when 'slideNumber' is enabled */
.reveal .slide-number-pdf {
	display: block;
	position: absolute;
	font-size: 14px;
}

</script>


<script>
var style = document.createElement( 'style' );
style.type = 'text/css';
var style_script_id = window.location.search.match( /print-pdf/gi ) ? 'pdf-css' : 'paper-css';
var style_script = document.getElementById(style_script_id).text;
style.innerHTML = style_script;
document.getElementsByTagName('head')[0].appendChild(style);
</script>

    <link href="index_files/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
    <h1 class="title">R Wrangling</h1>
</section>

<section id="r-data-wrangling-and-manipulation" class="slide level2">
<h2>R Data Wrangling and Manipulation</h2>
<p>UC Berkeley Library and D-Lab</p>
<p>Spring 2018</p>
</section>
<section class="slide level2">

</section>
<section id="dplyrtidyr" class="slide level2">
<h2>dplyr/tidyr</h2>
<blockquote>
<p>It is often said that 80% of data analysis is spent on the process of cleaning and preparing the data. (Dasu and Johnson, 2003)</p>
</blockquote>
<ol type="1">
<li><strong><em>Manipulating</em></strong> data frames, e.g. filtering, summarizing, and conducting calculations across groups.</li>
<li><strong><em>Tidying</em></strong> data into the appropriate format. Reshaping for analysis</li>
<li>Attempting to <strong><em>describe relationships</em></strong> or conduct <strong><em>causal inference</em></strong></li>
</ol>
</section>
<section id="gapminder-dataset" class="slide level2">
<h2>Gapminder Dataset</h2>
<p>Provides values for life expectancy, GDP per capita, and population, every five years, from 1952 to 2007.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gapminder-FiveYearData.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)
<span class="kw">head</span>(gapminder)</code></pre></div>
<pre><code>##       country year      pop continent lifeExp gdpPercap
## 1 Afghanistan 1952  8425333      Asia  28.801  779.4453
## 2 Afghanistan 1957  9240934      Asia  30.332  820.8530
## 3 Afghanistan 1962 10267083      Asia  31.997  853.1007
## 4 Afghanistan 1967 11537966      Asia  34.020  836.1971
## 5 Afghanistan 1972 13079460      Asia  36.088  739.9811
## 6 Afghanistan 1977 14880372      Asia  38.438  786.1134</code></pre>
</section>
<section id="dataframe-manipulation-base-r" class="slide level2">
<h2>Dataframe manipulation Base R</h2>
<p>We can use base R functions to calculate summary statistics across groups of observations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(gapminder[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span>, <span class="st">&quot;gdpPercap&quot;</span>])</code></pre></div>
<pre><code>## [1] 2193.755</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(gapminder[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Americas&quot;</span>, <span class="st">&quot;gdpPercap&quot;</span>])</code></pre></div>
<pre><code>## [1] 7136.11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(gapminder[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span>, <span class="st">&quot;gdpPercap&quot;</span>])</code></pre></div>
<pre><code>## [1] 7902.15</code></pre>
</section>
<section id="dataframe-manipulation-dplyr" class="slide level2">
<h2>Dataframe manipulation dplyr</h2>
<p><small>Luckily, the <a href="https://cran.r-project.org/web/packages/dplyr/dplyr.pdf"><code>dplyr</code></a> package provides a number of very useful functions for manipulating dataframes. These functions will save you time by reducing repetition. </small></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>)

<span class="co">#or install.packages(&#39;tidyverse&#39;)</span></code></pre></div>
<p><small>Here we’re going to cover 6 of the most commonly used functions as well as using pipes (<code>%&gt;%</code>) to combine them.</p>
<ol type="1">
<li><code>select()</code></li>
<li><code>filter()</code></li>
<li><code>group_by()</code></li>
<li><code>summarize()</code></li>
<li><code>mutate()</code></li>
<li><code>arrange()</code></li>
</ol>
<p></small></p>
<p><small>Now let’s load the package:</small></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)

<span class="co">#or library(tidyverse)</span></code></pre></div>
</section>
<section id="dplyr--select" class="slide level2">
<h2>dplyr- select()</h2>
<p><small>Imagine that we just received the gapminder dataset, but are only interested in a few variables in it. We could use the <strong>select()</strong> function to keep only the variables we select.</small></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">year_country_gdp &lt;-<span class="st"> </span><span class="kw">select</span>(gapminder, year, country, gdpPercap)
<span class="kw">head</span>(year_country_gdp)</code></pre></div>
<pre><code>##   year     country gdpPercap
## 1 1952 Afghanistan  779.4453
## 2 1957 Afghanistan  820.8530
## 3 1962 Afghanistan  853.1007
## 4 1967 Afghanistan  836.1971
## 5 1972 Afghanistan  739.9811
## 6 1977 Afghanistan  786.1134</code></pre>
</section>
<section id="dplyr--select-1" class="slide level2">
<h2>dplyr- select()</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">year_country_gdp &lt;-<span class="st"> </span><span class="kw">select</span>(gapminder, year, country, gdpPercap)
<span class="kw">head</span>(year_country_gdp)</code></pre></div>
<pre><code>##   year     country gdpPercap
## 1 1952 Afghanistan  779.4453
## 2 1957 Afghanistan  820.8530
## 3 1962 Afghanistan  853.1007
## 4 1967 Afghanistan  836.1971
## 5 1972 Afghanistan  739.9811
## 6 1977 Afghanistan  786.1134</code></pre>
</section>
<section id="dplyr--select-2" class="slide level2">
<h2>dplyr- select()</h2>
<p><img src="img/dplyr-fig1.png" /></p>
</section>
<section id="dplyr" class="slide level2">
<h2>dplyr %&gt;%</h2>
<p>The <strong>pipe</strong> operator is one of dplyr’s greatest strengths. It allows you combine several functions in a chain.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">year_country_gdp &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year,country,gdpPercap)</code></pre></div>
<p>is equivalent to:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">year_country_gdp &lt;-<span class="st"> </span><span class="kw">select</span>(gapminder, year, country, gdpPercap)</code></pre></div>
</section>
<section id="dplyr---filter" class="slide level2">
<h2>dplyr - filter()</h2>
<p>Now let’s say we’re only interested in African countries. We can combine <strong>select</strong> and <strong>filter</strong> to select only the observations where <code>continent</code> is <code>Africa</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">year_country_gdp_africa &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(year,country,gdpPercap)</code></pre></div>
</section>
<section id="dplyr---filter-1" class="slide level2">
<h2>dplyr - filter()</h2>
<p>Logicals</p>
<table>
<thead>
<tr class="header">
<th>&lt;</th>
<th>less than</th>
<th>!=</th>
<th>not equal to</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&gt;</td>
<td>greater than</td>
<td>%in%</td>
<td>group membership</td>
</tr>
<tr class="even">
<td>==</td>
<td>equal to</td>
<td>is.na</td>
<td>is NA</td>
</tr>
<tr class="odd">
<td>&lt;=</td>
<td>less than or equal to</td>
<td>!is.na</td>
<td>is not NA</td>
</tr>
<tr class="even">
<td>&gt;=</td>
<td>greater than or equal to</td>
<td>&amp; | ! xor any all</td>
<td>Boolean Operators</td>
</tr>
</tbody>
</table>
</section>
<section id="your-turn" class="slide level2">
<h2>Your Turn</h2>
<p>Create a new dataframe object called <code>africa_asia_lifeExp</code> that is filtered by “Africa” and “Asia” and has a lifeExp less than 60*. Select all variables except for <code>gdpPercap</code>. Use the pipe operator to chain the functions together.</p>
<p>*<small>hint: use both the |, &amp; boolean operator </small></p>
</section>
<section id="dplyrcalculations-across-groups" class="slide level2">
<h2>dplyr/calculations across groups</h2>
<p><small>A common task you’ll encounter when working with data is running calculations on different groups within the data. What if we wanted to calculate the mean GDP per capita for each continent? In base R, you would have to run the <strong>mean()</strong> function for each subset of data:</small></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span>])</code></pre></div>
<pre><code>## [1] 2193.755</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Americas&quot;</span>])</code></pre></div>
<pre><code>## [1] 7136.11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span>])</code></pre></div>
<pre><code>## [1] 7902.15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Europe&quot;</span>])</code></pre></div>
<pre><code>## [1] 14469.48</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Oceania&quot;</span>])</code></pre></div>
<pre><code>## [1] 18621.61</code></pre>
</section>
<section id="dplyrcalculations-across-groups-1" class="slide level2">
<h2>dplyr/Calculations Across Groups</h2>
<p>Assigning to data frames:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder<span class="op">$</span>mean.continent.GDP &lt;-<span class="st"> </span><span class="ot">NA</span>

gapminder<span class="op">$</span>mean.continent.GDP[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span>])

gapminder<span class="op">$</span>mean.continent.GDP[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Americas&quot;</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Americas&quot;</span>])

gapminder<span class="op">$</span>mean.continent.GDP[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span>])

gapminder<span class="op">$</span>mean.continent.GDP[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Europe&quot;</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Europe&quot;</span>])

gapminder<span class="op">$</span>mean.continent.GDP[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Oceania&quot;</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gapminder<span class="op">$</span>gdpPercap[gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Oceania&quot;</span>])</code></pre></div>
</section>
<section id="split-apply-combine" class="slide level2">
<h2>split-apply-combine</h2>
<p><img src="img/splitapply.png" /></p>
</section>
<section id="dplyr--group_by" class="slide level2">
<h2>dplyr- group_by()</h2>
<p><img src="img/dplyr-fig2.png" /></p>
</section>
<section id="dplyr---summarize" class="slide level2">
<h2>dplyr - summarize()</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gdp_bycontinents &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(continent) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_gdpPercap =</span> <span class="kw">mean</span>(gdpPercap))
<span class="kw">head</span>(gdp_bycontinents)</code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   continent mean_gdpPercap
##   &lt;fct&gt;              &lt;dbl&gt;
## 1 Africa              2194
## 2 Americas            7136
## 3 Asia                7902
## 4 Europe             14469
## 5 Oceania            18622</code></pre>
</section>
<section id="dplyr---summarize-1" class="slide level2">
<h2>dplyr - summarize()</h2>
<p><img src="img/dplyr-fig3.png" style="width:50.0%" /></p>
</section>
<section id="dplyr---summarize-2" class="slide level2">
<h2>dplyr - summarize()</h2>
<p>group_by() multiple variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gdp_bycontinents_byyear &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(continent, year) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_gdpPercap =</span> <span class="kw">mean</span>(gdpPercap))
<span class="kw">head</span>(gdp_bycontinents_byyear)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
## # Groups:   continent [1]
##   continent  year mean_gdpPercap
##   &lt;fct&gt;     &lt;int&gt;          &lt;dbl&gt;
## 1 Africa     1952           1253
## 2 Africa     1957           1385
## 3 Africa     1962           1598
## 4 Africa     1967           2050
## 5 Africa     1972           2340
## 6 Africa     1977           2586</code></pre>
</section>
<section id="dplyr---summarize-3" class="slide level2">
<h2>dplyr - summarize()</h2>
<p>group_by() multiple variables and defining multiple variable with summarize()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gdp_pop_bycontinents_byyear &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(continent, year) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_gdpPercap =</span> <span class="kw">mean</span>(gdpPercap),
              <span class="dt">sd_gdpPercap =</span> <span class="kw">sd</span>(gdpPercap),
              <span class="dt">mean_pop =</span> <span class="kw">mean</span>(pop),
              <span class="dt">sd_pop =</span> <span class="kw">sd</span>(pop))
<span class="kw">head</span>(gdp_pop_bycontinents_byyear)</code></pre></div>
<pre><code>## # A tibble: 6 x 6
## # Groups:   continent [1]
##   continent  year mean_gdpPercap sd_gdpPercap mean_pop   sd_pop
##   &lt;fct&gt;     &lt;int&gt;          &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 Africa     1952           1253          983  4570010  6317450
## 2 Africa     1957           1385         1135  5093033  7076042
## 3 Africa     1962           1598         1462  5702247  7957545
## 4 Africa     1967           2050         2848  6447875  8985505
## 5 Africa     1972           2340         3287  7305376 10130833
## 6 Africa     1977           2586         4142  8328097 11585184</code></pre>
</section>
<section id="exercise-2" class="slide level2">
<h2>Exercise 2</h2>
<ol type="1">
<li>Create a data frame containing the median <code>lifeExp</code> for each country</li>
</ol>
</section>
<section id="dplyr--mutate" class="slide level2">
<h2>dplyr- mutate()</h2>
<p>What if we wanted to add these values to our original data frame instead of creating a new object?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder_with_extra_vars &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(continent, year) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">mean_gdpPercap =</span> <span class="kw">mean</span>(gdpPercap),
              <span class="dt">sd_gdpPercap =</span> <span class="kw">sd</span>(gdpPercap),
              <span class="dt">mean_pop =</span> <span class="kw">mean</span>(pop),
              <span class="dt">sd_pop =</span> <span class="kw">sd</span>(pop))
<span class="kw">head</span>(gapminder_with_extra_vars)</code></pre></div>
<pre><code>## # A tibble: 6 x 11
## # Groups:   continent, year [6]
##   country      year      pop continent lifeExp gdpPercap mean.continent.G…
##   &lt;fct&gt;       &lt;int&gt;    &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;     &lt;dbl&gt;             &lt;dbl&gt;
## 1 Afghanistan  1952  8425333 Asia         28.8       779              7902
## 2 Afghanistan  1957  9240934 Asia         30.3       821              7902
## 3 Afghanistan  1962 10267083 Asia         32.0       853              7902
## 4 Afghanistan  1967 11537966 Asia         34.0       836              7902
## 5 Afghanistan  1972 13079460 Asia         36.1       740              7902
## 6 Afghanistan  1977 14880372 Asia         38.4       786              7902
## # ... with 4 more variables: mean_gdpPercap &lt;dbl&gt;, sd_gdpPercap &lt;dbl&gt;,
## #   mean_pop &lt;dbl&gt;, sd_pop &lt;dbl&gt;</code></pre>
</section>
<section id="dplyr--mutate-1" class="slide level2">
<h2>dplyr- mutate()</h2>
<p>We can use also use <strong>mutate()</strong> to create new variables prior to (or even after) summarizing information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gdp_pop_bycontinents_byyear &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">gdp_billion =</span> gdpPercap<span class="op">*</span>pop<span class="op">/</span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(continent, year) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_gdpPercap =</span> <span class="kw">mean</span>(gdpPercap),
              <span class="dt">sd_gdpPercap =</span> <span class="kw">sd</span>(gdpPercap),
              <span class="dt">mean_pop =</span> <span class="kw">mean</span>(pop),
              <span class="dt">sd_pop =</span> <span class="kw">sd</span>(pop),
              <span class="dt">mean_gdp_billion =</span> <span class="kw">mean</span>(gdp_billion),
              <span class="dt">sd_gdp_billion =</span> <span class="kw">sd</span>(gdp_billion))
<span class="kw">head</span>(gdp_pop_bycontinents_byyear)</code></pre></div>
<pre><code>## # A tibble: 6 x 8
## # Groups:   continent [1]
##   continent  year mean_gdpPercap sd_gdpPercap mean_pop   sd_pop
##   &lt;fct&gt;     &lt;int&gt;          &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 Africa     1952           1253          983  4570010  6317450
## 2 Africa     1957           1385         1135  5093033  7076042
## 3 Africa     1962           1598         1462  5702247  7957545
## 4 Africa     1967           2050         2848  6447875  8985505
## 5 Africa     1972           2340         3287  7305376 10130833
## 6 Africa     1977           2586         4142  8328097 11585184
## # ... with 2 more variables: mean_gdp_billion &lt;dbl&gt;, sd_gdp_billion &lt;dbl&gt;</code></pre>
</section>
<section id="dplyr---arrange" class="slide level2">
<h2>dplyr - arrange()</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder_with_extra_vars &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(continent, year) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">mean_gdpPercap =</span> <span class="kw">mean</span>(gdpPercap),
              <span class="dt">sd_gdpPercap =</span> <span class="kw">sd</span>(gdpPercap),
              <span class="dt">mean_pop =</span> <span class="kw">mean</span>(pop),
              <span class="dt">sd_pop =</span> <span class="kw">sd</span>(pop)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(year), continent)
<span class="kw">head</span>(gapminder_with_extra_vars)</code></pre></div>
<pre><code>## # A tibble: 6 x 11
## # Groups:   continent, year [1]
##   country      year      pop continent lifeExp gdpPercap mean.continent.G…
##   &lt;fct&gt;       &lt;int&gt;    &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;     &lt;dbl&gt;             &lt;dbl&gt;
## 1 Algeria      2007 33333216 Africa       72.3      6223              2194
## 2 Angola       2007 12420476 Africa       42.7      4797              2194
## 3 Benin        2007  8078314 Africa       56.7      1441              2194
## 4 Botswana     2007  1639131 Africa       50.7     12570              2194
## 5 Burkina Fa…  2007 14326203 Africa       52.3      1217              2194
## 6 Burundi      2007  8390505 Africa       49.6       430              2194
## # ... with 4 more variables: mean_gdpPercap &lt;dbl&gt;, sd_gdpPercap &lt;dbl&gt;,
## #   mean_pop &lt;dbl&gt;, sd_pop &lt;dbl&gt;</code></pre>
</section>
<section class="slide level2">

<h3 id="your-turn-1">Your turn</h3>
<ol type="1">
<li><p>Use dplyr to add a column to the gapminder dataset that contains the total population of the continent of each observation in a given year. For example, if the first observation is Afghanistan in 1952, the new column would contain the population of Asia in 1952.</p></li>
<li><p>Use dplyr to: (a) add a column called <code>gdpPercap_diff</code> that contains the difference between the observation’s <code>gdpPercap</code> and the mean <code>gdpPercap</code> of the continent in that year, (b) arrange the dataframe by the column you just created, in descending order (so that the relatively richest country/years are listed first)</p></li>
</ol>
</section>
<section id="tidying-data" class="slide level2">
<h2>Tidying Data</h2>
<p>Even before we conduct analysis or calculations, we need to put our data into the correct format. The goal here is to rearrange a messy dataset into one that is <strong>tidy</strong></p>
<p>The two most important properties of tidy data are:</p>
<ol type="1">
<li>Each column is a variable.</li>
<li>Each row is an observation.</li>
<li>Each value is in its own cell.</li>
</ol>
</section>
<section id="tidying-data-1" class="slide level2">
<h2>Tidying Data</h2>
<blockquote>
<p>“Happy families are all alike; every unhappy family is unhappy in its own way.” - Leo Tolstoy</p>
</blockquote>
<blockquote>
<p>“Tidy datasets are all alike but every messy dataset is messy in its own way.” – Hadley Wickham</p>
</blockquote>
</section>
<section id="tidying-data-2" class="slide level2">
<h2>Tidying Data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wide</code></pre></div>
<pre><code>##      name time1 time2 time3
## 1  Wilbur    67    56    70
## 2 Petunia    80    90    67
## 3 Gregory    64    50   101</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">long</code></pre></div>
<pre><code>##      name time heartrate
## 1  Wilbur    1        67
## 2 Petunia    1        80
## 3 Gregory    1        64
## 4  Wilbur    2        56
## 5 Petunia    2        90
## 6 Gregory    2        50
## 7  Wilbur    3        70
## 8 Petunia    3        67
## 9 Gregory    3        10</code></pre>
<p>Which one of these do you think is the <em>tidy</em> format?</p>
</section>
<section class="slide level2">

<p>This data frame is somewhere in between the purely ‘long’ and ‘wide’ formats. We have 3 “ID variables” (<code>continent</code>, <code>country</code>, <code>year</code>) and 3 “Observation variables” (<code>pop</code>, <code>lifeExp</code>, <code>gdpPercap</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(gapminder)</code></pre></div>
<pre><code>##       country year      pop continent lifeExp gdpPercap mean.continent.GDP
## 1 Afghanistan 1952  8425333      Asia  28.801  779.4453            7902.15
## 2 Afghanistan 1957  9240934      Asia  30.332  820.8530            7902.15
## 3 Afghanistan 1962 10267083      Asia  31.997  853.1007            7902.15
## 4 Afghanistan 1967 11537966      Asia  34.020  836.1971            7902.15
## 5 Afghanistan 1972 13079460      Asia  36.088  739.9811            7902.15
## 6 Afghanistan 1977 14880372      Asia  38.438  786.1134            7902.15</code></pre>
</section>
<section id="tidying-datatidyr" class="slide level2">
<h2>Tidying Data/tidyr</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyr)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gap_wide &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gapminder_wide.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">head</span>(gap_wide)</code></pre></div>
<pre><code>##   continent      country gdpPercap_1952 gdpPercap_1957 gdpPercap_1962
## 1    Africa      Algeria      2449.0082      3013.9760      2550.8169
## 2    Africa       Angola      3520.6103      3827.9405      4269.2767
## 3    Africa        Benin      1062.7522       959.6011       949.4991
## 4    Africa     Botswana       851.2411       918.2325       983.6540
## 5    Africa Burkina Faso       543.2552       617.1835       722.5120
## 6    Africa      Burundi       339.2965       379.5646       355.2032
##   gdpPercap_1967 gdpPercap_1972 gdpPercap_1977 gdpPercap_1982
## 1      3246.9918      4182.6638      4910.4168      5745.1602
## 2      5522.7764      5473.2880      3008.6474      2756.9537
## 3      1035.8314      1085.7969      1029.1613      1277.8976
## 4      1214.7093      2263.6111      3214.8578      4551.1421
## 5       794.8266       854.7360       743.3870       807.1986
## 6       412.9775       464.0995       556.1033       559.6032
##   gdpPercap_1987 gdpPercap_1992 gdpPercap_1997 gdpPercap_2002
## 1      5681.3585      5023.2166      4797.2951      5288.0404
## 2      2430.2083      2627.8457      2277.1409      2773.2873
## 3      1225.8560      1191.2077      1232.9753      1372.8779
## 4      6205.8839      7954.1116      8647.1423     11003.6051
## 5       912.0631       931.7528       946.2950      1037.6452
## 6       621.8188       631.6999       463.1151       446.4035
##   gdpPercap_2007 lifeExp_1952 lifeExp_1957 lifeExp_1962 lifeExp_1967
## 1      6223.3675       43.077       45.685       48.303       51.407
## 2      4797.2313       30.015       31.999       34.000       35.985
## 3      1441.2849       38.223       40.358       42.618       44.885
## 4     12569.8518       47.622       49.618       51.520       53.298
## 5      1217.0330       31.975       34.906       37.814       40.697
## 6       430.0707       39.031       40.533       42.045       43.548
##   lifeExp_1972 lifeExp_1977 lifeExp_1982 lifeExp_1987 lifeExp_1992
## 1       54.518       58.014       61.368       65.799       67.744
## 2       37.928       39.483       39.942       39.906       40.647
## 3       47.014       49.190       50.904       52.337       53.919
## 4       56.024       59.319       61.484       63.622       62.745
## 5       43.591       46.137       48.122       49.557       50.260
## 6       44.057       45.910       47.471       48.211       44.736
##   lifeExp_1997 lifeExp_2002 lifeExp_2007 pop_1952 pop_1957 pop_1962
## 1       69.152       70.994       72.301  9279525 10270856 11000948
## 2       40.963       41.003       42.731  4232095  4561361  4826015
## 3       54.777       54.406       56.728  1738315  1925173  2151895
## 4       52.556       46.634       50.728   442308   474639   512764
## 5       50.324       50.650       52.295  4469979  4713416  4919632
## 6       45.326       47.360       49.580  2445618  2667518  2961915
##   pop_1967 pop_1972 pop_1977 pop_1982 pop_1987 pop_1992 pop_1997 pop_2002
## 1 12760499 14760787 17152804 20033753 23254956 26298373 29072015 31287142
## 2  5247469  5894858  6162675  7016384  7874230  8735988  9875024 10866106
## 3  2427334  2761407  3168267  3641603  4243788  4981671  6066080  7026113
## 4   553541   619351   781472   970347  1151184  1342614  1536536  1630347
## 5  5127935  5433886  5889574  6634596  7586551  8878303 10352843 12251209
## 6  3330989  3529983  3834415  4580410  5126023  5809236  6121610  7021078
##   pop_2007
## 1 33333216
## 2 12420476
## 3  8078314
## 4  1639131
## 5 14326203
## 6  8390505</code></pre>
</section>
<section id="gather" class="slide level2">
<h2>gather()</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gap_long &lt;-<span class="st"> </span>gap_wide <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">gather</span>(obstype_year, obs_values, <span class="dv">3</span><span class="op">:</span><span class="dv">38</span>)
<span class="kw">head</span>(gap_long)</code></pre></div>
<pre><code>##   continent      country   obstype_year obs_values
## 1    Africa      Algeria gdpPercap_1952  2449.0082
## 2    Africa       Angola gdpPercap_1952  3520.6103
## 3    Africa        Benin gdpPercap_1952  1062.7522
## 4    Africa     Botswana gdpPercap_1952   851.2411
## 5    Africa Burkina Faso gdpPercap_1952   543.2552
## 6    Africa      Burundi gdpPercap_1952   339.2965</code></pre>
<p><small> We put 3 arguments into the <code>gather()</code> function:</p>
<ol type="1">
<li><p>the name of the new column for the new ID variable (<code>obstype_year</code>)</p></li>
<li><p>the name for the new amalgamated observation variable (<code>obs_value</code>)</p></li>
<li><p>the indices of the old observation variables (<code>3:38</code>, signalling columns 3 through 38) that we want to gather into one variable. Notice that we don’t want to melt down columns 1 and 2, as these are considered “ID” variables.</p></li>
</ol>
<p></small></p>
</section>
<section id="gather-1" class="slide level2">
<h2>gather()</h2>
<p>We can also select observation variables using:</p>
<ul>
<li>variable indices</li>
<li>variable names</li>
<li><code>x:z</code> to select all variables between x and z</li>
<li><code>-y</code> to <em>exclude</em> y</li>
<li><code>starts_with(x, ignore.case = TRUE)</code>: all names that starts with <code>x</code></li>
<li><code>ends_with(x, ignore.case = TRUE)</code>: all names that ends with <code>x</code></li>
<li><code>contains(x, ignore.case = TRUE)</code>: all names that contain <code>x</code></li>
</ul>
</section>
<section id="gather-2" class="slide level2">
<h2>gather()</h2>
<p>The same thing with the <code>starts_with</code> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># with the starts_with() function</span>
gap_long &lt;-<span class="st"> </span>gap_wide <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">gather</span>(obstype_year, obs_values, <span class="kw">starts_with</span>(<span class="st">&#39;pop&#39;</span>),
           <span class="kw">starts_with</span>(<span class="st">&#39;lifeExp&#39;</span>), <span class="kw">starts_with</span>(<span class="st">&#39;gdpPercap&#39;</span>))
<span class="kw">head</span>(gap_long)</code></pre></div>
<pre><code>##   continent      country obstype_year obs_values
## 1    Africa      Algeria     pop_1952    9279525
## 2    Africa       Angola     pop_1952    4232095
## 3    Africa        Benin     pop_1952    1738315
## 4    Africa     Botswana     pop_1952     442308
## 5    Africa Burkina Faso     pop_1952    4469979
## 6    Africa      Burundi     pop_1952    2445618</code></pre>
</section>
<section id="gather-3" class="slide level2">
<h2>gather()</h2>
<p>the <code>-</code> operator:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gap_long &lt;-<span class="st"> </span>gap_wide <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(obstype_year, obs_values, <span class="op">-</span>continent, <span class="op">-</span>country)
<span class="kw">head</span>(gap_long)</code></pre></div>
<pre><code>##   continent      country   obstype_year obs_values
## 1    Africa      Algeria gdpPercap_1952  2449.0082
## 2    Africa       Angola gdpPercap_1952  3520.6103
## 3    Africa        Benin gdpPercap_1952  1062.7522
## 4    Africa     Botswana gdpPercap_1952   851.2411
## 5    Africa Burkina Faso gdpPercap_1952   543.2552
## 6    Africa      Burundi gdpPercap_1952   339.2965</code></pre>
</section>
<section id="separate" class="slide level2">
<h2>separate()</h2>
<p>in our long dataset, <code>obstype_year</code> actually contains 2 pieces of information, the observation type (<code>pop</code>, <code>lifeExp</code>, or <code>gdpPercap</code>) and the <code>year</code>.</p>
<p>We can use the <code>separate()</code> function to split the character strings into multiple variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gap_long_sep &lt;-<span class="st"> </span>gap_long <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">separate</span>(obstype_year, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&#39;obs_type&#39;</span>,<span class="st">&#39;year&#39;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.integer</span>(year))
<span class="kw">head</span>(gap_long_sep)</code></pre></div>
<pre><code>##   continent      country  obs_type year obs_values
## 1    Africa      Algeria gdpPercap 1952  2449.0082
## 2    Africa       Angola gdpPercap 1952  3520.6103
## 3    Africa        Benin gdpPercap 1952  1062.7522
## 4    Africa     Botswana gdpPercap 1952   851.2411
## 5    Africa Burkina Faso gdpPercap 1952   543.2552
## 6    Africa      Burundi gdpPercap 1952   339.2965</code></pre>
</section>
<section id="spread" class="slide level2">
<h2>spread()</h2>
<p>The opposite of <code>gather()</code> is <code>spread()</code>. It spreads our observation variables back out to make a wider table. We can use this function to spread our <code>gap_long()</code> to the original “medium” format.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gap_medium &lt;-<span class="st"> </span>gap_long_sep <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(obs_type, obs_values)
<span class="kw">head</span>(gap_medium)</code></pre></div>
<pre><code>##   continent country year gdpPercap lifeExp      pop
## 1    Africa Algeria 1952  2449.008  43.077  9279525
## 2    Africa Algeria 1957  3013.976  45.685 10270856
## 3    Africa Algeria 1962  2550.817  48.303 11000948
## 4    Africa Algeria 1967  3246.992  51.407 12760499
## 5    Africa Algeria 1972  4182.664  54.518 14760787
## 6    Africa Algeria 1977  4910.417  58.014 17152804</code></pre>
</section>
<section class="slide level2">

<p>All we need is some quick fixes to make this dataset identical to the original <code>gapminder</code> dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gapminder-FiveYearData.csv&quot;</span>)
<span class="kw">head</span>(gapminder)</code></pre></div>
<pre><code>##       country year      pop continent lifeExp gdpPercap
## 1 Afghanistan 1952  8425333      Asia  28.801  779.4453
## 2 Afghanistan 1957  9240934      Asia  30.332  820.8530
## 3 Afghanistan 1962 10267083      Asia  31.997  853.1007
## 4 Afghanistan 1967 11537966      Asia  34.020  836.1971
## 5 Afghanistan 1972 13079460      Asia  36.088  739.9811
## 6 Afghanistan 1977 14880372      Asia  38.438  786.1134</code></pre>
</section>
<section class="slide level2">

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># rearrange columns</span>
gap_medium &lt;-<span class="st"> </span>gap_medium <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">select</span>(country, year, pop, continent, lifeExp, gdpPercap)
<span class="kw">head</span>(gap_medium)</code></pre></div>
<pre><code>##   country year      pop continent lifeExp gdpPercap
## 1 Algeria 1952  9279525    Africa  43.077  2449.008
## 2 Algeria 1957 10270856    Africa  45.685  3013.976
## 3 Algeria 1962 11000948    Africa  48.303  2550.817
## 4 Algeria 1967 12760499    Africa  51.407  3246.992
## 5 Algeria 1972 14760787    Africa  54.518  4182.664
## 6 Algeria 1977 17152804    Africa  58.014  4910.417</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># arrange by country, continent, and year</span>
gap_medium &lt;-<span class="st"> </span>gap_medium <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(country,continent,year)
<span class="kw">head</span>(gap_medium)</code></pre></div>
<pre><code>##       country year      pop continent lifeExp gdpPercap
## 1 Afghanistan 1952  8425333      Asia  28.801  779.4453
## 2 Afghanistan 1957  9240934      Asia  30.332  820.8530
## 3 Afghanistan 1962 10267083      Asia  31.997  853.1007
## 4 Afghanistan 1967 11537966      Asia  34.020  836.1971
## 5 Afghanistan 1972 13079460      Asia  36.088  739.9811
## 6 Afghanistan 1977 14880372      Asia  38.438  786.1134</code></pre>
</section>
<section id="extra-resources" class="slide level2">
<h2>Extra Resources</h2>
<p><code>dplyr</code> and <code>tidyr</code> have many more functions to help you wrangle and manipulate your data. See the <a href="https://www.rstudio.com/resources/cheatsheets/">Data Wrangling Cheat Sheet</a> for more.</p>
</section>
<section class="slide level2">

<h3 id="your-turn-2">Your Turn</h3>
<ol type="1">
<li><p>Subset the results from the last exercise to select only the <code>country</code>, <code>year</code>, and <code>gdpPercap_diff</code> columns. Use <code>tidyr</code> put it in wide format so that countries are rows and years are columns. You might need to use <code>ungroup()</code> before the <code>select()</code> function.</p></li>
<li><p>Now turn the dataframe above back into the long format with three columns: <code>country</code>, <code>year</code>, and <code>gdpPercap_diff</code>.</p></li>
</ol>
</section>
    </div>
  </div>

  <script src="index_files/reveal.js-3.3.0.1/lib/js/head.min.js"></script>
  <script src="index_files/reveal.js-3.3.0.1/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Push each slide change to the browser history
        history: true,
        // Vertical centering of slides
        center: true,
        // Transition style
        transition: 'fade', // none/fade/slide/convex/concave/zoom
        // Transition style for full page slide backgrounds
        backgroundTransition: 'default', // none/fade/slide/convex/concave/zoom
        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,



        chalkboard: {
        },

        keyboard: {
          67: function() { RevealChalkboard.toggleNotesCanvas() },    // toggle notes canvas when 'c' is pressed
          66: function() { RevealChalkboard.toggleChalkboard() }, // toggle chalkboard when 'b' is pressed
          46: function() { RevealChalkboard.clear() },    // clear chalkboard when 'DEL' is pressed
           8: function() { RevealChalkboard.reset() },    // reset chalkboard data on current slide when 'BACKSPACE' is pressed
          68: function() { RevealChalkboard.download() }, // downlad recorded chalkboard drawing when 'd' is pressed
        },

        // Optional reveal.js plugins
        dependencies: [
          { src: 'index_files/reveal.js-3.3.0.1/plugin/chalkboard/chalkboard.js', async: true },
        ]
      });
    </script>
  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

<script>
  (function() {
    if (window.jQuery) {
      Reveal.addEventListener( 'slidechanged', function(event) {  
        window.jQuery(event.previousSlide).trigger('hidden');
        window.jQuery(event.currentSlide).trigger('shown');
      });
    }
  })();
</script>


  </body>
</html>
