## Challenge 1 

Here is a dataset inspired by an Economist/YouGov Poll about the importance of unemployment in the United States. 

```{r}
challenge_1 <- tibble(
  issue_importance = c("Very Important", "Somewhat Important",
                       "Not very Important", "Unimportant"),
  `18-29` = c(.59, .28, .08, .05),
  `30-44` = c(.66, .27, .06, .02),
  `45-64` = c(.69, .28, .03, .01),
  `65+` = c(.7, .27, .02, .01)
)

head(challenge_1)
```

Answer the following: 

1. How many observations are in the data set?

*16. While they are only 4 rows in this table, there are four categories of issue importance and four age groups. 4x4 = 16 total observations.*

2. How many columns are in the data set?

```{r}
ncol(challenge_1)
```

3. Is every column a variable?

*No! This data is messy. The first column is a variable that contains the universe of issue importance answers. However, the next five columns are all instances of the variable age.*

## Exercise 1

#Create a new object called africa_asia that is filtered by “Africa” and “Asia”*. Select all variables except for gdpPercap. 
#Use the pipe operator to chain the functions together.

africa_asia_lifeExp <- gapminder %>% 
  filter(continent == "Africa"& lifeExp < 60 | continent == "Asia" & lifeExp <60) %>%
  select(-gdpPercap)
  
  
  
## Exercise 2

#Use dplyr to create a data frame containing the median lifeExp for each country

median_country_lifeExp <- gapminder %>% group_by(country) %>% 
  summarize(median_lifeExp = median(lifeExp))



## Exercise 3

#Use dplyr to add a column to the gapminder dataset that contains the 
#total population of the continent of each observation in a given year.

gapminder <- gapminder %>% group_by(continent, year) %>% 
  mutate(continent_pop = sum(pop))
  

  
## Exercise 4

#Use dplyr to: (a) add a column called `gdpPercap_diff` that contains the difference between 
#the observation's `gdpPercap` and the mean `gdpPercap` of the continent in that year,
#(b) arrange the dataframe by the column you just created, in descending order (so that 
#the relatively richest country/years are listed first)
gapminder_gdpPercap_diff <- gapminder %>%  group_by(continent, year) %>% 
   mutate(mean_continent_gdp = mean(gdpPercap),
          gdpPercap_diff = gdpPercap - mean_continent_gdp) %>% 
  arrange(desc(gdpPercap_diff))
  
  
  
## Exercise  5
  
#Subset the results from the last exercise to select only the country, year, and gdpPercap_diff columns. 
#Use tidyr put it in wide format # so that countries are rows and years are columns. You might need to use  ungroup() before the select() function.
#Then turn the dataframe above back into the long format with three columns: country, year, and gdpPercap_diff.
  
gapminder_wide <- gapminder_gdpPercap_diff %>% ungroup() %>% select(country, year, gdpPercap_diff) %>% 
   spread(year, gdpPercap_diff)

gapminder_long <- gapminder_wide %>% gather(year, gdpPercap_diff, `1952`: `2007`)


